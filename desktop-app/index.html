<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniConsulting Desktop</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #f8fafc;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            text-align: center;
            max-width: 500px;
        }

        .logo {
            font-size: 64px;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 32px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #f97316, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: #94a3b8;
            margin-bottom: 40px;
        }

        .status-box {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ef4444;
            animation: pulse 2s infinite;
        }

        .status-dot.connected {
            background: #22c55e;
            animation: none;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .status-text {
            font-weight: 600;
        }

        .user-email {
            color: #94a3b8;
            font-size: 14px;
            margin-top: 5px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, #f97316, #ea580c);
            color: white;
            box-shadow: 0 4px 20px rgba(249, 115, 22, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 30px rgba(249, 115, 22, 0.4);
        }

        .btn-secondary {
            background: #334155;
            color: #f8fafc;
            border: 1px solid #475569;
        }

        .btn-secondary:hover {
            background: #475569;
        }

        .btn-danger {
            background: #dc2626;
            color: white;
        }

        .hidden {
            display: none !important;
        }

        .version {
            position: fixed;
            bottom: 20px;
            color: #475569;
            font-size: 12px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="logo">üéì</div>
        <h1>UniConsulting</h1>
        <p class="subtitle">AI-Powered University Application Assistant</p>

        <div class="status-box">
            <div class="status-indicator">
                <div class="status-dot" id="statusDot"></div>
                <span class="status-text" id="statusText">Not Logged In</span>
            </div>
            <div class="user-email" id="userEmail"></div>
        </div>

        <!-- Not logged in state -->
        <div id="loginSection">
            <button class="btn btn-primary" id="loginBtn" onclick="loginWithBrowser()">
                üîê Login with Browser
            </button>
        </div>

        <!-- Logged in state -->
        <div id="loggedInSection" class="hidden">
            <button class="btn btn-primary" onclick="openDashboard()" style="margin-bottom: 15px;">
                ‚ú® Open Dashboard
            </button>
            <br>
            <button class="btn btn-secondary" onclick="logout()">
                Logout
            </button>
        </div>
    </div>

    <div class="version">Version 1.0.0</div>

    <script>
        // State
        let isLoggedIn = false;
        let currentToken = null;
        let currentEmail = null;

        // UI Elements
        const statusDot = document.getElementById('statusDot');
        const statusText = document.getElementById('statusText');
        const userEmail = document.getElementById('userEmail');
        const loginSection = document.getElementById('loginSection');
        const loggedInSection = document.getElementById('loggedInSection');

        // Check if running in Electron
        const isElectron = window.electron?.isDesktop;

        // Initialize
        async function init() {
            if (!isElectron) {
                statusText.textContent = 'Running in Browser (Desktop features disabled)';
                return;
            }

            // Check for stored token
            const auth = await window.electron.getAuthToken();
            if (auth.token) {
                handleLogin(auth.token, auth.email);
            }

            // Listen for auth events
            window.electron.onAuthSuccess((data) => {
                console.log('Auth success:', data);
                handleLogin(data.token, data.email);
            });

            window.electron.onAuthRestored((data) => {
                console.log('Auth restored:', data);
                handleLogin(data.token, data.email);
            });
        }

        // Handle login
        function handleLogin(token, email) {
            isLoggedIn = true;
            currentToken = token;
            currentEmail = email;

            statusDot.classList.add('connected');
            statusText.textContent = 'Connected';
            userEmail.textContent = email || 'Logged in';
            loginSection.classList.add('hidden');
            loggedInSection.classList.remove('hidden');
        }

        // Open browser for login
        function loginWithBrowser() {
            if (isElectron) {
                window.electron.loginWithBrowser();
            } else {
                alert('This feature requires the desktop app');
            }
        }

        // Open dashboard
        function openDashboard() {
            if (isElectron) {
                // Navigate to main app (will use stored token)
                window.location.href = 'https://uniconsulting.netlify.app/student-dashboard';
            }
        }

        // Logout
        async function logout() {
            if (isElectron) {
                await window.electron.logout();
            }
            isLoggedIn = false;
            currentToken = null;
            currentEmail = null;

            statusDot.classList.remove('connected');
            statusText.textContent = 'Not Logged In';
            userEmail.textContent = '';
            loginSection.classList.remove('hidden');
            loggedInSection.classList.add('hidden');
        }

        // Initialize on load
        init();
    </script>
</body>

</html>