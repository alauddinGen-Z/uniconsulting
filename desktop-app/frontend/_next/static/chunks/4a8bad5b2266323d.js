(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20278,e=>{"use strict";let s=(0,e.i(75254).default)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);e.s(["Target",()=>s],20278)},72520,e=>{"use strict";let s=(0,e.i(75254).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>s],72520)},7233,e=>{"use strict";let s=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],7233)},94563,e=>{"use strict";var s=e.i(43476);function t(){return(0,s.jsxs)("div",{className:"loadingspinner",children:[(0,s.jsx)("div",{id:"square1"}),(0,s.jsx)("div",{id:"square2"}),(0,s.jsx)("div",{id:"square3"}),(0,s.jsx)("div",{id:"square4"}),(0,s.jsx)("div",{id:"square5"})]})}e.s(["default",()=>t])},55436,e=>{"use strict";let s=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>s],55436)},46897,e=>{"use strict";let s=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>s],46897)},70273,e=>{"use strict";let s=(0,e.i(75254).default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>s],70273)},47133,e=>{"use strict";e.s(["API_ENDPOINTS",0,{APPROVE_STUDENT:"/api/approve-student",AI_REVIEW:"https://ylwyuogdfwugjexyhtrq.supabase.co/functions/v1/ai-review",DOCUMENT_OCR:"https://ylwyuogdfwugjexyhtrq.supabase.co/functions/v1/document-ocr",UNIVERSITY_MATCHER:"https://ylwyuogdfwugjexyhtrq.supabase.co/functions/v1/university-matcher"}])},75376,e=>{"use strict";var s=e.i(43476);e.i(47167);var t=e.i(71645),a=e.i(55436),l=e.i(83086),r=e.i(32095),i=e.i(46897);let c=(0,e.i(75254).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var n=e.i(20278),d=e.i(7233),x=e.i(43531),o=e.i(72520),h=e.i(70273),m=e.i(27454),u=e.i(90615),p=e.i(46696),f=e.i(94563),j=e.i(47133);function N(){let{students:e,isLoading:N}=(0,m.useTeacherData)(),[g,v]=(0,t.useState)(null),[b,y]=(0,t.useState)(""),[w,S]=(0,t.useState)(!1),[I,k]=(0,t.useState)([]),[A,_]=(0,t.useState)(""),[C,T]=(0,t.useState)(null),M=(0,u.createClient)(),E=e.filter(e=>"approved"===e.approval_status),R=b?E.filter(e=>e.full_name?.toLowerCase().includes(b.toLowerCase())||e.preferred_university?.toLowerCase().includes(b.toLowerCase())):E,q=E.find(e=>e.id===g),P=async()=>{if(g){S(!0),k([]),_("");try{let{data:{session:e}}=await M.auth.getSession(),s=await fetch(j.API_ENDPOINTS.UNIVERSITY_MATCHER,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e?.access_token||""}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inlsd3l1b2dkZnd1Z2pleHlodHJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ0NjExODEsImV4cCI6MjA4MDAzNzE4MX0.clEe8v_lzTXJrOQJsAUn18CCHx3JRHCcBficHqwP-1g"},body:JSON.stringify({studentId:g})}),t=await s.json();console.log("AI Matcher response:",t),t.success?(k(t.matches||[]),_(t.summary||""),p.toast.success(`Found ${t.matches?.length||0} university matches!`)):p.toast.error(t.error||"Failed to find matches")}catch(e){console.error("Matching error:",e),p.toast.error("Failed to connect to AI service")}finally{S(!1)}}},O=async e=>{if(g){T(e.name);try{let{data:s}=await M.from("student_universities").select("id").eq("student_id",g).eq("university_name",e.name).maybeSingle();if(s){p.toast.info("University already in student's list"),T(null);return}let t="match";e.matchScore>=85?t="safety":e.matchScore<60&&(t="reach");let{error:a}=await M.from("student_universities").insert({student_id:g,university_name:e.name,country:e.country,category:t,notes:`AI Match Score: ${e.matchScore}%. ${e.reasons.join(" ")}`,application_status:"researching"});if(a)throw a;p.toast.success(`Added ${e.name} to student's list!`)}catch(e){console.error("Add error:",e),p.toast.error("Failed to add university")}finally{T(null)}}};return(0,s.jsxs)("div",{className:"h-full flex flex-col",children:[(0,s.jsx)("div",{className:"flex-none mb-6",children:(0,s.jsxs)("header",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-14 h-14 bg-purple-100 rounded-2xl flex items-center justify-center",children:(0,s.jsx)(l.Sparkles,{className:"w-7 h-7 text-purple-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-black font-montserrat text-slate-900 mb-1",children:"AI UNIVERSITY MATCHER"}),(0,s.jsx)("p",{className:"text-slate-500 font-medium",children:"Match students with their ideal universities using AI"})]})]})}),(0,s.jsxs)("div",{className:"flex-1 flex gap-6 min-h-0",children:[(0,s.jsxs)("div",{className:"w-80 flex-shrink-0 bg-white rounded-2xl shadow-lg border border-slate-100 flex flex-col overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-slate-100",children:[(0,s.jsxs)("h3",{className:"font-bold text-slate-900 mb-3 flex items-center gap-2",children:[(0,s.jsx)(n.Target,{className:"w-5 h-5 text-purple-500"}),"Select Student"]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(a.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,s.jsx)("input",{value:b,onChange:e=>y(e.target.value),placeholder:"Search students...",className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 rounded-xl text-sm border-0 focus:ring-2 focus:ring-purple-500/20 outline-none"})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:N?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)(f.default,{})}):0===R.length?(0,s.jsxs)("div",{className:"p-8 text-center text-slate-400 text-sm",children:[(0,s.jsx)(r.GraduationCap,{className:"w-10 h-10 mx-auto mb-3 opacity-30"}),(0,s.jsx)("p",{className:"font-medium",children:"No approved students"}),(0,s.jsx)("p",{className:"text-xs mt-1",children:"Approve students first to use AI matching"})]}):(0,s.jsx)("div",{className:"p-2",children:R.map(e=>(0,s.jsxs)("button",{onClick:()=>{v(e.id),k([]),_("")},className:`w-full p-3 rounded-xl flex items-center gap-3 transition-all mb-1 ${g===e.id?"bg-purple-500 text-white shadow-lg shadow-purple-500/30":"hover:bg-slate-50 text-slate-700"}`,children:[(0,s.jsx)("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm ${g===e.id?"bg-white/20 text-white":"bg-gradient-to-br from-purple-400 to-pink-500 text-white"}`,children:e.full_name?.charAt(0)||"?"}),(0,s.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[(0,s.jsx)("p",{className:"font-bold text-sm truncate",children:e.full_name||"Unnamed"}),(0,s.jsx)("p",{className:`text-xs truncate ${g===e.id?"text-white/70":"text-slate-400"}`,children:e.preferred_major||"No major set"})]}),(0,s.jsx)(o.ArrowRight,{className:`w-4 h-4 ${g===e.id?"text-white":"text-slate-300"}`})]},e.id))})})]}),(0,s.jsx)("div",{className:"flex-1 bg-white rounded-2xl shadow-lg border border-slate-100 flex flex-col overflow-hidden",children:g?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"p-6 bg-gradient-to-r from-purple-600 to-pink-600 text-white",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-white/20 flex items-center justify-center text-2xl font-bold",children:q?.full_name?.charAt(0)||"?"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:q?.full_name}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-white/80 text-sm",children:[q?.preferred_major&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(r.GraduationCap,{className:"w-4 h-4"}),q.preferred_major]}),q?.preferred_country&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(i.MapPin,{className:"w-4 h-4"}),q.preferred_country]})]})]})]}),(0,s.jsx)("button",{onClick:P,disabled:w,className:"px-6 py-3 bg-white text-purple-600 rounded-xl font-bold flex items-center gap-2 hover:bg-purple-50 transition-colors disabled:opacity-50 shadow-lg",children:w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-purple-600 border-t-transparent rounded-full animate-spin"}),"Analyzing..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Sparkles,{className:"w-5 h-5"}),"Find Matches"]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 mt-6",children:[(0,s.jsxs)("div",{className:"bg-white/10 rounded-xl p-3 text-center",children:[(0,s.jsx)("p",{className:"text-xl font-bold",children:q?.gpa||"-"}),(0,s.jsx)("p",{className:"text-xs text-white/70",children:"GPA"})]}),(0,s.jsxs)("div",{className:"bg-white/10 rounded-xl p-3 text-center",children:[(0,s.jsx)("p",{className:"text-xl font-bold",children:q?.sat_total||"-"}),(0,s.jsx)("p",{className:"text-xs text-white/70",children:"SAT"})]}),(0,s.jsxs)("div",{className:"bg-white/10 rounded-xl p-3 text-center",children:[(0,s.jsx)("p",{className:"text-xl font-bold",children:q?.ielts_overall||"-"}),(0,s.jsx)("p",{className:"text-xs text-white/70",children:"IELTS"})]}),(0,s.jsxs)("div",{className:"bg-white/10 rounded-xl p-3 text-center",children:[(0,s.jsx)("p",{className:"text-xl font-bold",children:q?.toefl_total||"-"}),(0,s.jsx)("p",{className:"text-xs text-white/70",children:"TOEFL"})]})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:w?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-slate-400",children:[(0,s.jsx)(f.default,{}),(0,s.jsx)("p",{className:"mt-6 text-lg font-medium text-slate-600",children:"AI is analyzing student profile..."}),(0,s.jsx)("p",{className:"text-sm",children:"This may take a few seconds"})]}):0===I.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-slate-400",children:[(0,s.jsx)(n.Target,{className:"w-16 h-16 mb-4 opacity-30"}),(0,s.jsx)("p",{className:"font-medium text-lg text-slate-500",children:"No matches yet"}),(0,s.jsx)("p",{className:"text-sm",children:'Click "Find Matches" to get AI recommendations'})]}):(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)("div",{className:"grid gap-4",children:I.map((e,t)=>{var a,l;return(0,s.jsxs)("div",{className:"bg-slate-50 rounded-2xl p-5 hover:bg-white hover:shadow-lg hover:border-purple-200 border border-transparent transition-all",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center text-white font-bold text-lg",children:["#",t+1]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-lg text-slate-900",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[(0,s.jsx)(i.MapPin,{className:"w-4 h-4"}),e.country]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:`px-3 py-1 rounded-lg font-bold text-sm ${(a=e.matchScore)>=80?"text-green-600 bg-green-100":a>=60?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100"}`,children:[e.matchScore,"% - ",(l=e.matchScore)>=85?"Safety":l>=70?"Match":l>=50?"Reach":"High Reach"]}),(0,s.jsx)("button",{onClick:()=>O(e),disabled:C===e.name,className:"p-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors disabled:opacity-50",title:"Add to student's list",children:C===e.name?(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,s.jsx)(d.Plus,{className:"w-5 h-5"})})]})]}),(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)("ul",{className:"space-y-1",children:e.reasons.map((e,t)=>(0,s.jsxs)("li",{className:"text-sm text-slate-600 flex items-start gap-2",children:[(0,s.jsx)(x.Check,{className:"w-4 h-4 text-green-500 flex-shrink-0 mt-0.5"}),e]},t))})}),(0,s.jsxs)("div",{className:"flex items-center gap-6 text-sm text-slate-500 pt-3 border-t border-slate-200",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(h.Star,{className:"w-4 h-4"}),e.requirements]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(c,{className:"w-4 h-4"}),e.tuitionRange]})]})]},t)})})})})]}):(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400 p-8",children:[(0,s.jsx)("div",{className:"w-24 h-24 rounded-full bg-purple-100 flex items-center justify-center mb-6",children:(0,s.jsx)(l.Sparkles,{className:"w-12 h-12 text-purple-300"})}),(0,s.jsx)("h3",{className:"font-bold text-xl text-slate-500 mb-2",children:"Select a Student"}),(0,s.jsx)("p",{className:"text-sm text-center max-w-md",children:"Choose a student from the list to find AI-recommended universities based on their profile, grades, and test scores."})]})})]})]})}function g(){return(0,s.jsx)("div",{className:"flex-1 min-h-0",children:(0,s.jsx)(N,{})})}e.s(["default",()=>g],75376)}]);