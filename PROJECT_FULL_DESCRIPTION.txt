# UniConsulting - Complete Project Description

## Project Type: MVP (Minimum Viable Product) for University Consulting CRM

## Purpose
UniConsulting is a **SaaS platform for university application consultants** (agents who help international students apply to universities abroad). It connects:
- **Students** - Who need help with applications
- **Consultants/Teachers** - Who manage student cases

---

## Tech Stack

| Layer | Technology |
|-------|------------|
| Frontend | Next.js 16 (App Router), React 19, TypeScript |
| Styling | Tailwind CSS v4 with CSS Variables |
| Backend | Supabase (PostgreSQL + Auth + Realtime + Storage + Edge Functions) |
| AI | Google Gemini 2.0 Flash (OCR, Essay Review, University Matching) |
| Hosting | Netlify (frontend), Supabase (backend) |

---

## Architecture

```
/src
├── /app                    # Next.js App Router
│   ├── /api               # API routes (AI features)
│   ├── /login             # Auth page
│   ├── /student/dashboard # Student portal
│   └── /teacher/dashboard # Teacher portal
├── /components
│   ├── /chat              # Chat system (StudentChat, ChatView)
│   ├── /shared            # Reusable (SettingsModal, ProfileModal)
│   ├── /student           # Student-only components
│   └── /teacher           # Teacher-only components
├── /lib
│   ├── i18n.tsx           # Multilingual (EN/RU/KG)
│   ├── theme-config.ts    # Brand theming
│   ├── ai-cache.ts        # AI response caching
│   └── gemini-client.ts   # Robust Gemini wrapper
└── /hooks                 # Custom React hooks
```

---

## Core Features

### 1. Authentication & Roles
- **Email/Password login** via Supabase Auth
- **Two roles**: `student` and `teacher`
- Students must be **approved** by a teacher before accessing features

### 2. Student Dashboard
Students can:
- **Upload documents** (Passport, Transcripts, IELTS, SAT, TOEFL)
- **AI Document OCR**: Auto-extract scores from uploaded documents
- **Write essays** with version history
- **AI Essay Review**: Get AI feedback on essays
- **Chat 1:1** with assigned consultant
- **Track university list** and application status

### 3. Teacher Dashboard
Teachers can:
- **View Kanban board** of students by stage
- **Approve pending students**
- **View student profiles** and documents
- **AI University Matcher**: Find best-fit universities for students
- **Chat with students**
- **Admin panel** (for admin teachers)

### 4. AI-Powered Features
| Feature | Endpoint | Description |
|---------|----------|-------------|
| Document OCR | `/api/document-ocr` + Edge Function | Extracts scores from IELTS/SAT/GPA/Passport images |
| Essay Review | `/api/ai-review` | AI grades essays on grammar, clarity, structure |
| University Matcher | `/api/university-matcher` | Recommends universities based on student profile |

All AI calls have:
- **Caching** (7-30 days) to reduce costs
- **Retry logic** (3 retries with exponential backoff)

### 5. Multilingual Support
- Languages: English (EN), Russian (RU), Kyrgyz (KG)
- Stored in `localStorage` as `uni_language`
- Uses static dictionaries (no API translation)

### 6. Dynamic Theming
- Brand presets: `UNICONSULTING_THEME` (orange), `GLOBAL_COMPASS_THEME` (blue)
- CSS variables for easy white-labeling
- Configured in `src/lib/theme-config.ts`

---

## Database Schema (Supabase/PostgreSQL)

### Key Tables
| Table | Purpose |
|-------|---------|
| `profiles` | User profiles (name, role, teacher_id, scores, etc.) |
| `essays` | Student essays with AI review results |
| `essay_versions` | Version history for essays |
| `documents` | Uploaded document metadata |
| `student_universities` | Universities student is applying to |
| `conversations` | Chat conversations |
| `messages` | Chat messages |
| `conversation_participants` | Who is in each conversation |
| `ai_query_cache` | Cached AI responses |

### RLS (Row Level Security)
- All tables have RLS enabled
- Students can only see their own data
- Teachers can see data of students assigned to them

---

## Environment Variables

```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=xxx
SUPABASE_SERVICE_ROLE_KEY=xxx

# Google AI
GEMINI_API_KEY=xxx

# Optional
NEXT_PUBLIC_GOOGLE_MAPS_KEY=xxx
```

---

## Key User Flows

### Student Registration Flow
1. Student signs up with email
2. Account is `pending` (is_approved = false)
3. Teacher approves student → creates chat conversation
4. Student can now access full dashboard

### Document Upload Flow
1. Student uploads document image
2. Frontend sends to `/api/document-ocr` (or Edge Function)
3. Gemini Vision extracts text/scores
4. Scores are saved to student profile
5. Original document stored in Supabase Storage

### Essay Review Flow
1. Student writes/pastes essay
2. Clicks "Get AI Feedback"
3. Frontend calls `/api/ai-review`
4. Response cached for 7 days
5. Student sees grammar/clarity/structure scores

---

## File Structure Highlights

| File | Purpose |
|------|---------|
| `src/app/layout.tsx` | Root layout with LanguageProvider, theme class |
| `src/components/student/DashboardSidebar.tsx` | Student navigation |
| `src/components/teacher/TeacherSidebar.tsx` | Teacher navigation |
| `src/components/chat/StudentChat.tsx` | 1:1 chat with assigned teacher |
| `src/lib/i18n.tsx` | Translation dictionary and hooks |
| `src/lib/theme-config.ts` | Brand color presets |
| `supabase/functions/document-ocr/index.ts` | Edge Function for OCR |

---

## Current Status: Production MVP

- ✅ Authentication working
- ✅ Student/Teacher dashboards
- ✅ Document upload + AI OCR
- ✅ Essay writing + AI review
- ✅ University matcher AI
- ✅ Real-time chat
- ✅ Multilingual (EN/RU/KG)
- ✅ Dynamic theming
- ✅ Deployed to Netlify + Supabase

---

## Known Limitations (MVP Scope)

- No payment processing
- No email notifications
- Teacher presence (online status) is simulated
- No mobile app (responsive web only)
- Single tenant (no multi-company support yet)

---

*Last Updated: 2025-12-13*
